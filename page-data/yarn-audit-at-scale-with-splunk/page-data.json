{"componentChunkName":"component---src-templates-blog-post-js","path":"/yarn-audit-at-scale-with-splunk/","result":{"data":{"site":{"siteMetadata":{"title":"Alacrity"}},"markdownRemark":{"id":"22dc804e-2ffc-586d-a402-96e000411112","excerpt":"GitHub announced the general availability of security alerts on November 2017. These alerts are visible to repository maintainers and help identify potential…","html":"<p>GitHub announced the general availability of security alerts on <a href=\"https://github.blog/2017-11-16-introducing-security-alerts-on-github/\">November 2017</a>. These alerts are visible to repository maintainers and help identify potential vulnerable third-party libraries used in the project. You are also presented with possible remediation steps to resolve the vulnerabilities. GitHub also offers automated PRs from dependabot, although you would still need to triage some alerts time-to-time if dependabot is unable to.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/119b210c12d772aa9a21abba2fde4b15/12e1b/dependabot-prs.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.949367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABJ0AAASdAHeZh94AAAA3UlEQVQY042PSW6EMBBFuUoztDGDCzB2MzWtAJFyh9z/HC9yk0SJlEUWTzWo6lf96FpZCuOoxaOrjiRvSHWgJcnlSVac+dlvyIqOWJlnL8TUCJlrSIwQqbrHji+oqv8ejFVNomrisPApGoTOYy1lO1I2A1U3UcqI7BPz+0H1uBGFD+204eYDO250w4Nm2DHDK8ZOmH5B3J3Gr4hfz/hVuzviVqRfEbuizY0o2BG/4JaDfg7stONOObyh+w1tPPmfuF+5Fk94LgoWg6j+MaTKlrSwxNXARRku1/pfBK0P68San05v0bEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Dependabot PRs\"\n        title=\"Dependabot PRs\"\n        src=\"/static/119b210c12d772aa9a21abba2fde4b15/f058b/dependabot-prs.png\"\n        srcset=\"/static/119b210c12d772aa9a21abba2fde4b15/c26ae/dependabot-prs.png 158w,\n/static/119b210c12d772aa9a21abba2fde4b15/6bdcf/dependabot-prs.png 315w,\n/static/119b210c12d772aa9a21abba2fde4b15/f058b/dependabot-prs.png 630w,\n/static/119b210c12d772aa9a21abba2fde4b15/40601/dependabot-prs.png 945w,\n/static/119b210c12d772aa9a21abba2fde4b15/78612/dependabot-prs.png 1260w,\n/static/119b210c12d772aa9a21abba2fde4b15/12e1b/dependabot-prs.png 1607w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>You may ask how GitHub decides when to raise an alert? These alerts are consequences of advisories reported on <a href=\"https://github.com/advisories?query=type%3Areviewed\">GitHub Advisory Database</a>.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.44303797468354%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAABNUlEQVQoz02RSW7EIBREfZVuj2AGY8Bjuye3kijKIqtcIPscIqsscueKPm07vSg9AaKKX0SmPaGdnuDHG/w4oznc0J9eIOoBMauQ8hopN0HJwn2usMtk4KNoL8qEBVMehfLIyjqokLRuQGdZaZf9fz4aEldRWCSfv2A/fsHevlG+/4CdP1FIC+kOyKVDupktEm4J9Fsw021QaXpESdkgER323AfG3KHuzhgur3DDDDfOdw4z7DDDNxO0HSDsGEKVn6D9EVVzhKg7RAnT2OcSu7REnEvEhQ792eEK051h+2sIIJr+AusnKDIzHbh0YYpcED1y2ZKhCSbUAXFfaHDdQvspGMv6/hpFDBXcR895hXjtLxXhA8uaRmZVMFkNSZRIfazd8KoDVx6Mm3Bxu7P9rgJNyrTDHyD12ebkKNLXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"GitHub Advisory Database\"\n        title=\"GitHub Advisory Database\"\n        src=\"/static/8d2a71a70c35ed59f0796a8a00454cd4/f058b/gh-advisory-db.png\"\n        srcset=\"/static/8d2a71a70c35ed59f0796a8a00454cd4/c26ae/gh-advisory-db.png 158w,\n/static/8d2a71a70c35ed59f0796a8a00454cd4/6bdcf/gh-advisory-db.png 315w,\n/static/8d2a71a70c35ed59f0796a8a00454cd4/f058b/gh-advisory-db.png 630w,\n/static/8d2a71a70c35ed59f0796a8a00454cd4/40601/gh-advisory-db.png 945w,\n/static/8d2a71a70c35ed59f0796a8a00454cd4/78612/gh-advisory-db.png 1260w,\n/static/8d2a71a70c35ed59f0796a8a00454cd4/9c2cf/gh-advisory-db.png 1557w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2>Overview</h2>\n<p>In this blog, we will be exploring how to monitor the security state of the node dependencies across multiple repositories with the help of yarn and Splunk. Let us dive right into it.</p>\n<h2>Workflow</h2>\n<p>In a nutshell, the implementation we will look at can be presented using the following diagram.\n<img src=\"/4828c9b019f0f365a1c21571c3815f97/workflow.svg\" alt=\"Workflow\"></p>\n<h2>Collecting Security Alerts in Splunk</h2>\n<p>We will be using <code class=\"language-text\">yarn audit</code> to get the security alerts for a project. The next step is to figure out how to regularly send the data to Splunk from GitHub or when someone commits to the repository. GitHub actions to the rescue! We can use Splunk <a href=\"https://docs.splunk.com/Documentation/Splunk/8.2.5/Data/UsetheHTTPEventCollector\">HTTP Event Collector</a> to collect data at Splunk-end. For non-Splunk readers, it exposes a webhook where you can post your data on-demand, and Splunk handles the rest. You can find the source code of the GitHub action at <a href=\"https://github.com/harsh8398/react-app-with-vuln-telemetry/blob/d5e38063e46d9bfd9c93b873f15c8d38f0af2853/.github/workflows/report-yarn-audit.yml\">harsh8398/react-app-with-vuln-telemetry</a>.</p>\n<h2>Inspecting Data in Splunk</h2>\n<p>Let’s inspect the received event in Splunk and identify useful information. Yarn audit returns two types of information.</p>\n<ol>\n<li>auditAdvisory - Each record represents an alert with the third-party dependency details\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6947c67b3d94fb71e51537a1f5b711fb/b6e34/audit-advisory.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.60759493670886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAAAx0lEQVQoz52RUWrDMBBEdf9TlRKcQpxC0jMU/BE3tlPJsna1L6ipW5NCIV4YDSOxb4Xknrd7qt2Bl9c3nqqaTX1kuz9S1YdVcl3X036cCWNkGiNxGJiSoDmTV8iVRURQVbBMak8k75nUWFNuGQpCCrB5J8WAmT0stwylpDvjmwaJ4TbkrmHeuz+b8w+Q4oD2HaFAY+CSIpc0MXx70afMnvCSvrJa/gUuJ1LeMo4EU4IK2exf2cL/3hDo/Ug7eNoQSVkf+oyZcQVBgmye7uEiVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"auditAdvisory\"\n        title=\"auditAdvisory\"\n        src=\"/static/6947c67b3d94fb71e51537a1f5b711fb/f058b/audit-advisory.png\"\n        srcset=\"/static/6947c67b3d94fb71e51537a1f5b711fb/c26ae/audit-advisory.png 158w,\n/static/6947c67b3d94fb71e51537a1f5b711fb/6bdcf/audit-advisory.png 315w,\n/static/6947c67b3d94fb71e51537a1f5b711fb/f058b/audit-advisory.png 630w,\n/static/6947c67b3d94fb71e51537a1f5b711fb/40601/audit-advisory.png 945w,\n/static/6947c67b3d94fb71e51537a1f5b711fb/b6e34/audit-advisory.png 1103w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></li>\n<li>auditSummary - Includes count of vulnerabilities and dependencies\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/91acbf2d4eca5c92bdf990080d5564b8/d5bfb/audit-summary.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.30379746835443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAAA20lEQVQoz5WQb0vDMBCH+/0/lYi0IqviRBCmyBz+e7Ha0WW5JL08ktAXLQprf3Bccrl78kuKq5s7Lqua69sHqtWai6qmrNd5Xa7uKXOeH4X3gX3zQ9seEOdwxiDmhO8VjRFVXRRFHIaCDxkQRbAvG2S3xXVHokaWqEiwsdR75PUZ+/SIfdtijc31dPGcKHRwkDY5q+Lfd7jPD4IVQjofDZx3GOPEQZL7/sKLG1pSfcmTR8DsBPDNHjVmWp9JnQJTFiE4oQse6cMf97OBSb1G2s7SHC0H8fz3HeeAv5QsvCJIGH9FAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"auditSummary\"\n        title=\"auditSummary\"\n        src=\"/static/91acbf2d4eca5c92bdf990080d5564b8/f058b/audit-summary.png\"\n        srcset=\"/static/91acbf2d4eca5c92bdf990080d5564b8/c26ae/audit-summary.png 158w,\n/static/91acbf2d4eca5c92bdf990080d5564b8/6bdcf/audit-summary.png 315w,\n/static/91acbf2d4eca5c92bdf990080d5564b8/f058b/audit-summary.png 630w,\n/static/91acbf2d4eca5c92bdf990080d5564b8/40601/audit-summary.png 945w,\n/static/91acbf2d4eca5c92bdf990080d5564b8/d5bfb/audit-summary.png 1072w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></li>\n</ol>\n<h2>Representing Data in a Splunk Dashboard</h2>\n<p>Based on all the information available from the <code class=\"language-text\">yarn audit</code> output, we can quickly present it in a more digestible form using Splunk. Following is the primary example dashboard that I’ve built.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f29a9e82c557b967292b11cb0ded6927/c1b63/yarn-audit-splunk-dashboard.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 176.58227848101265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Yarn Audit - Splunk Dashboard\"\n        title=\"Yarn Audit - Splunk Dashboard\"\n        src=\"/static/f29a9e82c557b967292b11cb0ded6927/f058b/yarn-audit-splunk-dashboard.png\"\n        srcset=\"/static/f29a9e82c557b967292b11cb0ded6927/c26ae/yarn-audit-splunk-dashboard.png 158w,\n/static/f29a9e82c557b967292b11cb0ded6927/6bdcf/yarn-audit-splunk-dashboard.png 315w,\n/static/f29a9e82c557b967292b11cb0ded6927/f058b/yarn-audit-splunk-dashboard.png 630w,\n/static/f29a9e82c557b967292b11cb0ded6927/40601/yarn-audit-splunk-dashboard.png 945w,\n/static/f29a9e82c557b967292b11cb0ded6927/c1b63/yarn-audit-splunk-dashboard.png 1200w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>TL;DR</h2>\n<p>We can use a continuous integration workflow to post security alerts data from multiple repositories to Splunk and get a single-pane view of security alerts spanning multiple GitHub repositories or even from alternative git-hosted platforms.</p>","frontmatter":{"title":"Yarn Audit at Scale using Splunk","date":"April 03, 2022","description":"This blog demonstrates how to audit vulnerabilities in node packages across the organization with Splunk.","previewImage":"yarn-audit-at-scale-with-splunk.png"}},"previous":{"fields":{"slug":"/serving-static-react-app-using-nginx/"},"frontmatter":{"title":"Serve static React app using NGINX"}},"next":{"fields":{"slug":"/better-coding-practices-python-part-1/"},"frontmatter":{"title":"Better Coding Practices / Python / Part-1"}}},"pageContext":{"id":"22dc804e-2ffc-586d-a402-96e000411112","previousPostId":"db5a7616-e3b9-52b8-bc05-1dbaae87f4a9","nextPostId":"62527321-d313-5ee1-9724-177884b29adf"}},"staticQueryHashes":["3134424800","3257411868"]}